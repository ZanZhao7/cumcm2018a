\documentclass[utf8]{ctexart}
\usepackage{amsmath}
\usepackage{bf}
\usepackage{bm}
\begin{document}
    \section{求解问题一}

    利用热传导方程:
    给定区间\[x_0,x_1\dots\]
    \[k\frac{\partial^2 u}{\partial x^2} = \frac{\partial u}{\partial t}\rho c |_{x_{i-1}<x<x_{i}}\]
    在不同介质交换处,由\(\frac{\partial{q}}{\partial{x}} = \frac{\partial{u}}{\partial{t}} \rho c \)
    可得:
    \[ 
        \lim_{\delta \to 0^+} 
        k_{i+1 }\frac{\partial{u(x_i+\delta)}}{\partial{x}} 
        -
        \int_{x_i}^{x_i+\delta}\frac{\partial{u}}{\partial{t}} \rho_{i+1} c_{i+1} dx 
        = 
        \lim_{\delta \to 0^+} 
        k_{i} \frac{\partial{u(x_i-\delta)}}{\partial{x}}
        - 
        \int_{x_i}^{x_i-\delta}\frac{\partial{u}}{\partial{t}} \rho_i c_i dx
        =
        q(x_i)
    \]
    在左端,考虑对流换热,由:\(q = h\Delta u\)
    有:
    \[
        \lim_{\delta \to 0^+} 
        k\frac{\partial{u(\delta)}}{\partial{x}} 
        - 
        h[u(0) - u_w]
        -
        \int_{0}^{\delta}\frac{\partial{u}}{\partial{t}} \rho c dx 
        = 0
    \]
    右端亦然.
    采用C-K方法做差分:
    在单一介质内部,有:
    \[
        \frac{1}{2}
        \left(
            \frac{u_{i+1}^{n+1} + u_{i-1}^{n+1} - 2u_{i}^{n+1} }{\Delta x^2}
            +
            \frac{u_{i+1}^{n} + u_{i-1}^{n} - 2u_{i}^{n} }{\Delta x^2}
        \right)
        k
        =
        \frac{ u_{i}^{n+1} - u_{i}^{n} }{\Delta t} \rho c
    \]
    记:
    \( r = \frac{k \Delta t}{ 2 \rho c \Delta x^2 } \)
    整理得:
    \[
        -ru_{i+1}^{n+1} + (1+2r)u_{i}^{n+1} + -ru_{i-1}^{n+1}
        =
        ru_{i+1}^{n} + (1-2r)u_{i}^{n} + ru_{i-1}^{n}
    \]
    在介质交界处,假设小区块分成两半,每一半介质不同,记前一种介质的热传导率为\(k_p\),后一种介质的热传导率为\(k_n\),
    \(\rho c\)是前后两种介质单位体积热容的平均值,有:
    \[
        \frac{1}{2}
        \left[
            \frac{k_n u_{i+1}^{n+1} + k_p u_{i-1}^{n+1} - (k_p+k_n)u_{i}^{n+1}) }{\Delta x^2}
            +
            \frac{k_n u_{i+1}^{n} + k_p u_{i-1}^{n} - (k_p+k_n)u_{i}^{n} }{\Delta x^2}
        \right]
        =
        \frac{ u_{i}^{n+1} - u_{i}^{n} }{\Delta t} \rho c
    \]
    在两端处,以左端为例:
    \[
        \frac{1}{2}
        \left[
            k\frac{ u_{2}^{n+1}  - u_{1}^{n+1} }{\Delta x}
            -
            h_l(u_{1}^{n+1} - u_w)
            +
            k\frac{ u_{2}^{n}  - u_{1}^{n} }{\Delta x}
            -
            h_l(u_{1}^{n} - u_w)
        \right]
        =
        \frac{ u_{i}^{n+1} - u_{i}^{n} }{\Delta t} \rho c \frac{\Delta x}{2}
    \]
    根据这样多重线性映射的关系,得到递推式:
    \(\bf{R_n}\bf{u}^{n+1} = \bf{R_p}\bf{u}^{n} + \bf{q}\)
    记:
    \(\bf{A} = \bf{R}_n^{-1}\bf{R}_p\)
    \(\bf{b} = \bf{R}_n^{-1}\bf{q}\)
    有递推关系式
    \(\bf{u}^{n+1} = \bf{A}\bf{u}^{n} + \bf{b}\)
    记这个映射有不动点:
    \(\bf{u}_s = \bf{A}\bf{u}_s + \bf{b}\)
    则有:
    \(  \bf{u}^{n+1} - \bf{u}_s = \bf{A} (\bf{u}^n - \bf{u}_s) \)
    即:
    \(  \bf{u}^{n} = \bf{A}^n (\bf{u}^0 - \bf{u}_s) + \bf{u}_s\)
    显然的:
    \(\bf{u}_s = (\bf{I} - \bf{A})^{-1}\bf{b}\)
    这样就可以快速的求解任意时刻的温度分布:
    \[  \bf{u}|_{t = t_0} = \bf{A}^{\frac{t_0}{\Delta t}} (\bf{u}^0 - \bf{u}_s) + \bf{u}_s\]

    问题1的求解:
    记\(h_l,h_r\)分别为左右两边的换热系数,\(u_l,u_r\)分别为左右两边的温度,\(u_{wl},u_{wr}\)分别为左右两边的环境温度
    根据稳态的热平衡,我们可以列出如下关系式:
    \[\sum_{i=1}^4 \frac{L_i}{k_i} + \frac{1}{h_l} + \frac{1}{h_r} = \frac{u_{wr}-u_{wl}}{q}\]
    又由热平衡:\( h_r(u_l-u_{wl}) = q\)
    不难得出\(h_r,h_l\)的关系:
    \[h_l = \frac{\alpha h_r}{1+\beta hr}\]
    其中参数\(\alpha = 2.4296 ,\beta = 0.2821\)
    不难发现\(h_r\)大致在80~120之间,我们在这个区间上二分查找一个\(h_r\),使得计算数据与原始数据的总标准差:
    \[S = \sqrt{\frac{\sum_{i=1}^{N}(u_i-\hat{u_i})^2}{N}}\]
    取得最小值
    计算可得\(h_r\)大致为:100.63,\(h_l\)大致为8.319,相对应的\(S = 0.052\)
    \(S-h_r\)的关系见下图

    问题2的分析:
    一定时间后的皮肤表面温度一定是随着材料厚度单调递减的.因此最佳厚度一定是恰好在55分钟的时候达到\(44^{\circ}C\)的厚度.
    问题2的求解:
    采用二分查找的方法,确定这个厚度
    通过计算,可以得到第二层厚度\(L_2\)与55分钟的温度\(u_{3300}\)的关系如图:
    可以得到\(L2\)的最优厚度为20.9mm
\end{document}